import{r as n,k as f,g as c}from"./index-Dwht1Bct.js";const l=n({name:"",pass:"",form:"",email:""}),o=n(!1);n();const m={name:2,pass:6,passRepeat:6,email:5};let i=null;function v(e){i=e}function p(e,s,t){return e.length<s?`Must be at least ${s} characters`:e.length>t?`Must be no more than ${t} characters`:null}function d(e){return/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(e)?null:"Invalid email address"}function h(e,s){let t=!1;for(const a in e){let r=null;a==="email"?r=d(e[a]):r=p(e[a],m[a],25),r===null?l.value[a]="":(l.value[a]=r,t=!0)}if(s==="reg"){if(e.repeatPass!==e.pass)l.value.repeatPass="Passwords don't match",t=!0;else if(l.value.repeatPass="",!t){const a={fullName:e.name,email:e.email,password:e.pass};u(a,"register")}}else if(s==="login"&&!t){const a={email:e.email,password:e.pass};u(a,"auth")}}async function u(e,s){try{l.value.email="",o.value=!0;const a=await(await fetch(`${f}/${s}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)})).json(),r=a.token;localStorage.setItem("userName",a.data.fullName),localStorage.setItem("token",r),c(i,"/home",!0)}catch(t){s==="register"?(l.value.email="This email is taken",console.log("Ошибка при регистрации:",t)):(l.value.email="Сheck the correctness of the entered data",console.log("Ошибка при входе:",t))}finally{o.value=!1}}function k(e){l.value={name:"",pass:"",form:"",email:""},c(i,e,!1)}export{k as c,l as e,o as l,v as p,h as v};
