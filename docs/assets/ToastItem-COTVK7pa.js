import{E as z,s as N,r as g,_ as f,o as d,c as p,a as o,d as L,m as B,G as I,H as R,u as t,h as E,j as V,e as u,b as i,I as K,n as F,J as M,t as x,A as P}from"./index-DUnEtLtO.js";import{L as c,a as j}from"./LoadingItem-DFBUV5za.js";import{B as T}from"./ButtonControl-CQyoPHln.js";const D=z("apiKey",{state:()=>({apiKey:"0TRXKX0-4QCM482-GQQPR1K-C8Z4MAT"})}),G=D(),v=N(),k=g(!1),$=g(!1),y=g(0),b=g([]),C=g(""),n=g({userName:`${localStorage.getItem("userName")}`,name:"",genre:"",year:"",length:"",isSeries:!1,image:"",rating:{imdb:"",kp:""}});function w(){k.value=!k.value}function Q(l){return encodeURIComponent(l).replace(/[!'()*]/g,function(s){return"%"+s.charCodeAt(0).toString(16)})}function X(){v.toastIsShow=!0,v.toastSuccess=!1,v.filmName=n.value.name,v.errorMessage="Movie with this title not found",v.callToast()}async function q(l){if(l==="")C.value="the field must be filled";else{C.value="",$.value=!0;const s=Q(l),m={method:"GET",headers:{accept:"application/json","X-API-KEY":`${G.apiKey}`}};try{const e=await(await fetch(`https://api.kinopoisk.dev/v1.4/movie/search?page=1&limit=5&query=${s}`,m)).json();b.value=e.docs,S(),console.log(b.value)}catch(r){console.error(r),X()}finally{$.value=!1}}}function S(){const l=b.value[y.value];n.value.name=l.name,n.value.year=`${l.year}`,n.value.length=l.isSeries?l.seriesLength:l.movieLength,n.value.isSeries=l.isSeries,n.value.image=l.poster.previewUrl,n.value.genre=H(l.genres),n.value.rating.imdb=l.rating.imdb.toFixed(1),n.value.rating.kp=l.rating.kp.toFixed(1),y.value===4?y.value=0:y.value++}function H(l){let s="";return l.forEach(m=>{s+=`${m.name}, `}),s=s.replace(/,\s*$/,""),s}const J={},Y={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 43.652 43.652",style:{"enable-background":"new 0 0 43.652 43.652"},"xml:space":"preserve"};function Z(l,s){return d(),p("svg",Y,s[0]||(s[0]=[o("path",{d:"M1.338 37.446a6.454 6.454 0 0 0 2.11 4.505 6.487 6.487 0 0 0 4.382 1.7 6.515 6.515 0 0 0 4.801-2.117l9.195-10.07 9.195 10.071a6.519 6.519 0 0 0 4.801 2.117 6.481 6.481 0 0 0 4.382-1.7 6.456 6.456 0 0 0 2.11-4.505 6.456 6.456 0 0 0-1.693-4.678L30.63 21.825l9.991-10.943a6.456 6.456 0 0 0 1.693-4.678 6.454 6.454 0 0 0-2.11-4.505A6.484 6.484 0 0 0 35.822 0a6.515 6.515 0 0 0-4.801 2.117l-9.195 10.07-9.195-10.071A6.518 6.518 0 0 0 7.829 0a6.486 6.486 0 0 0-4.381 1.699 6.456 6.456 0 0 0-2.11 4.505 6.456 6.456 0 0 0 1.693 4.678l9.991 10.944-9.991 10.941a6.458 6.458 0 0 0-1.693 4.679zm3.908-2.656 10.24-11.215c.898-.982.898-2.52.001-3.5L5.246 8.857a3.478 3.478 0 0 1-.912-2.518 3.476 3.476 0 0 1 1.138-2.426c1.371-1.252 3.695-1.143 4.944.225l9.629 10.546c.922 1.008 2.64 1.009 3.564-.001l9.628-10.544c1.251-1.371 3.575-1.477 4.944-.225a3.478 3.478 0 0 1 1.138 2.426 3.48 3.48 0 0 1-.912 2.519L28.166 20.073a2.611 2.611 0 0 0-.001 3.5L38.406 34.79c.63.69.954 1.584.912 2.519a3.476 3.476 0 0 1-1.138 2.426c-1.369 1.252-3.691 1.146-4.944-.225l-9.629-10.546c-.461-.504-1.11-.793-1.781-.793s-1.32.289-1.782.794l-9.628 10.544c-1.252 1.37-3.571 1.479-4.944.225a3.478 3.478 0 0 1-1.138-2.426 3.481 3.481 0 0 1 .912-2.518z"},null,-1)]))}const U=f(J,[["render",Z]]),h={},O={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 492.195 492.195",style:{"enable-background":"new 0 0 492.195 492.195"},"xml:space":"preserve"};function W(l,s){return d(),p("svg",O,s[0]||(s[0]=[o("path",{d:"M420.115 72.08C373.635 25.599 311.834 0 246.098 0 180.363 0 118.562 25.599 72.081 72.08 25.599 118.562 0 180.363 0 246.098s25.599 127.535 72.08 174.018c46.482 46.482 108.283 72.08 174.018 72.08 65.736 0 127.537-25.598 174.017-72.08 46.482-46.48 72.08-108.282 72.08-174.018 0-65.735-25.597-127.536-72.08-174.018zM246.098 442.195C137.97 442.195 50 354.227 50 246.098S137.97 50 246.098 50c108.128 0 196.097 87.969 196.097 196.098 0 108.129-87.968 196.097-196.097 196.097z"},null,-1),o("path",{d:"M246.098 157.33h-38.667c-13.807 0-25 11.193-25 25 0 13.808 11.193 25 25 25h13.667v178.768c0 13.807 11.193 25 25 25s25-11.193 25-25V182.33c0-13.806-11.193-25-25-25z"},null,-1),o("circle",{cx:"246.098",cy:"110.099",r:"30.667"},null,-1)]))}const _=f(h,[["render",W]]),ee={},te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve"};function se(l,s){return d(),p("svg",te,s[0]||(s[0]=[o("g",null,[o("g",null,[o("path",{d:"M463.702,162.655L442.491,14.164c-1.744-12.174-16.707-17.233-25.459-8.481l-30.894,30.894 C346.411,12.612,301.309,0,254.932,0C115.464,0,3.491,109.16,0.005,248.511c-0.19,7.617,5.347,14.15,12.876,15.234l59.941,8.569 c8.936,1.304,17.249-5.712,17.125-15.058C88.704,165.286,162.986,90,254.932,90c22.265,0,44.267,4.526,64.6,13.183l-29.78,29.78 c-8.697,8.697-3.761,23.706,8.481,25.459l148.491,21.211C456.508,181.108,465.105,172.599,463.702,162.655z"})])],-1),o("g",null,[o("g",null,[o("path",{d:"M499.117,249.412l-59.897-8.555c-7.738-0.98-17.124,5.651-17.124,16.143c0,90.981-74.019,165-165,165 c-22.148,0-44.048-4.482-64.306-13.052l28.828-28.828c8.697-8.697,3.761-23.706-8.481-25.459L64.646,333.435 c-9.753-1.393-18.39,6.971-16.978,16.978l21.21,148.492c1.746,12.187,16.696,17.212,25.459,8.481l31.641-31.626 C165.514,499.505,210.587,512,257.096,512c138.794,0,250.752-108.618,254.897-247.28 C512.213,257.088,506.676,250.496,499.117,249.412z"})])],-1)]))}const A=f(ee,[["render",se]]),oe={class:"wrapperr"},ne={class:"inner"},le={key:0,class:"explanation"},ae={class:"explanation--description"},re={class:"form"},ie={class:"autocomplete"},ue=L({__name:"AddMovie",props:{toggleAddMovie:{type:Function},nextPage:{type:Function}},setup(l){const s=l;async function m(r){await K(`movies?userName=${localStorage.getItem("userName")}`,r),F(),s.nextPage&&s.nextPage(),s.toggleAddMovie()}return B(()=>{I(-1)}),R(()=>{I(0),n.value={userName:`${localStorage.getItem("userName")}`,name:"",genre:"",year:"",length:"",isSeries:!1,image:"",rating:{imdb:"",kp:""}}}),(r,e)=>(d(),p("div",oe,[t($)?(d(),E(j,{key:0})):V("",!0),o("div",{onClick:e[0]||(e[0]=a=>r.toggleAddMovie()),class:"background"}),o("div",ne,[t(k)?(d(),p("div",le,[o("div",{onClick:e[1]||(e[1]=(...a)=>t(w)&&t(w)(...a)),class:"explanation--background"}),o("p",ae,[e[13]||(e[13]=u(" При нажатии на кнопку ")),e[14]||(e[14]=o("b",null,"Autocomplete",-1)),e[15]||(e[15]=u(" вы запросите данные по названию, указанному в поле ")),e[16]||(e[16]=o("b",null,'"Name"',-1)),e[17]||(e[17]=u(", с удалённой базы данных фильмов. Остальные поля будут автоматически заполнены, в том числе и поля карточки фильма. ")),e[18]||(e[18]=o("span",{class:"explanation--smile"},"😲",-1)),e[19]||(e[19]=u(" . Проверьте корректность введённого названия и полученных данный. Возможно сервис вернул не то, что вы имели ввиду. Вы можете нажать на кнопку ")),i(A,{class:"info info--small"}),e[20]||(e[20]=u(", тем самым поменяв вариант выдачи. Так же вы можете вручную заполнить все поля ")),e[21]||(e[21]=o("span",{class:"explanation--smile"},"🥲",-1)),e[22]||(e[22]=u(". Никакие поля, кроме ")),e[23]||(e[23]=o("b",null,'"Name"',-1)),e[24]||(e[24]=u(", не являются обязательными к заполнению ")),e[25]||(e[25]=o("span",{class:"explanation--smile"},"🫣",-1)),e[26]||(e[26]=u(". ")),e[27]||(e[27]=o("br",null,null,-1))])])):V("",!0),o("div",re,[o("button",{onClick:e[2]||(e[2]=a=>r.toggleAddMovie()),class:"close"},[i(U)]),i(c,{placeholder:"Мстители: Финал",description:"Film name*",inputType:"text",modelValue:t(n).name,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).name=a),error:t(C)},null,8,["modelValue","error"]),o("div",ie,[o("button",{onClick:e[4]||(e[4]=(...a)=>t(S)&&t(S)(...a)),class:"autocomplete--info"},[i(A,{class:"info"})]),i(T,{onClick:e[5]||(e[5]=a=>t(q)(t(n).name)),text:"Autocomplete",class:"autocomplete--button"}),o("button",{onClick:e[6]||(e[6]=(...a)=>t(w)&&t(w)(...a)),class:"autocomplete--info"},[i(_,{class:"info"})])]),i(c,{description:"Film genre",placeholder:"фантастика, боевик, драма",inputType:"text",modelValue:t(n).genre,"onUpdate:modelValue":e[7]||(e[7]=a=>t(n).genre=a)},null,8,["modelValue"]),i(c,{description:"Released",placeholder:"2019",inputType:"text",modelValue:t(n).year,"onUpdate:modelValue":e[8]||(e[8]=a=>t(n).year=a)},null,8,["modelValue"]),i(c,{description:"Duration",placeholder:"3 ч 1 мин",inputType:"text",modelValue:t(n).length,"onUpdate:modelValue":e[9]||(e[9]=a=>t(n).length=a)},null,8,["modelValue"]),i(c,{description:"Movie poster",placeholder:"https://kinopoisk-ru/avengers",inputType:"text",modelValue:t(n).image,"onUpdate:modelValue":e[10]||(e[10]=a=>t(n).image=a)},null,8,["modelValue"]),i(c,{description:"Is series",placeholder:"",inputType:"checkbox",modelValue:t(n).isSeries,"onUpdate:modelValue":e[11]||(e[11]=a=>t(n).isSeries=a)},null,8,["modelValue"]),i(T,{onClick:e[12]||(e[12]=a=>m(t(n))),text:"Add movie",class:"button"})])])]))}}),ke=f(ue,[["__scopeId","data-v-81b5e9de"]]),de={key:0,class:"success"},pe={class:"text"},me={class:"success--text"},ce={key:1,class:"error"},ge={class:"text"},ve={class:"error--text"},fe=L({__name:"ToastItem",setup(l){const s=N();return(m,r)=>(d(),p("div",{style:M({border:`3px solid var(${t(s).toastSuccess?"--color-main-green":"--color-red"})`}),class:P(`toast ${t(s).className}`)},[o("button",{onClick:r[0]||(r[0]=(...e)=>t(s).closeToast&&t(s).closeToast(...e)),class:"button"},[i(U,{style:M({fill:`var(${t(s).toastSuccess?"--color-main-green":"--color-red"})`})},null,8,["style"])]),t(s).toastSuccess?(d(),p("div",de,[r[1]||(r[1]=o("h3",{class:"title success--text"},"Success!",-1)),o("p",pe,[o("span",me,x(t(s).filmName),1),u(" "+x(t(s).message),1)])])):(d(),p("div",ce,[r[2]||(r[2]=o("h3",{class:"title error--text"},"Error",-1)),o("p",ge,[o("span",ve,x(t(s).filmName),1),u(" "+x(t(s).errorMessage===""?`not
        added to the list`:t(s).errorMessage),1)])]))],6))}}),$e=f(fe,[["__scopeId","data-v-aa3ef624"]]);export{ke as A,$e as T};
